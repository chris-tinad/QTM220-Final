ggplot(nba_sample, aes(x = Age, y = PTS, color = positions)) +
geom_point() +
geom_line(data = grid_parallel, aes(y = PTS_pred, color = positions), size = 1) +
labs(
title = "Parallel Lines Model",
x = "Age", y = "Points"
) +
theme_minimal()
set.seed(123)
## one-row data frame for the target prediction (Age=20, Center)
nba_center20 <- data.frame(
Age = 20,
positions = factor("center", levels = levels(nba_sample$positions))
)
## Running bootstrap sample
boot_pred <- array(dim = 10000) # creating empty array
n <- nrow(nba_sample)
for (rr in 1:10000) {
I <- sample(1:n, n, replace = TRUE) # resample rows with replacement
boot_dat <- nba_sample[I, ]
# factoring again...
boot_dat$positions <- factor(boot_dat$positions, levels = levels(nba_sample$positions))
fit <- lm(PTS ~ Age + positions, data = boot_dat) # fitting model on bootstrap data
boot_pred[rr] <- predict(fit, newdata = nba_center20)
}
## Getting the confidence interval
bootleft_CI <- quantile(boot_pred, 0.025)
bootright_CI <- quantile(boot_pred, 0.975)
cat("Bootstrap 95% Confidence Interval: (", bootleft_CI, ", ", bootright_CI, ")")
set.seed(123)
## one-row data frame for the target prediction (Age=20, Center)
nba_center20 <- data.frame(
Age = 20,
positions = factor("center", levels = levels(nba_sample$positions))
)
## Running bootstrap sample
boot_pred <- array(dim = 10000) # creating empty array
n <- nrow(nba_sample)
for (rr in 1:10000) {
I <- sample(1:n, n, replace = TRUE) # resample rows with replacement
boot_dat <- nba_sample[I, ]
# factoring again...
#boot_dat$positions <- factor(boot_dat$positions, levels = levels(nba_sample$positions))
fit <- lm(PTS ~ Age + positions, data = boot_dat) # fitting model on bootstrap data
boot_pred[rr] <- predict(fit, newdata = nba_center20)
}
## Getting the confidence interval
bootleft_CI <- quantile(boot_pred, 0.025)
bootright_CI <- quantile(boot_pred, 0.975)
cat("Bootstrap 95% Confidence Interval: (", bootleft_CI, ", ", bootright_CI, ")")
View(nba_center20)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(ggplot2)
library(dplyr)
data <- mtcars
data$cyl <- factor(data$cyl)  # make cyl categorical
head(data)
ggplot(data,
aes(x = wt, y = mpg)) +
geom_point() +
labs(title = "Scatterplot of MPG vs. Weight",
x = "Weight (1000 lbs)",
y = "Miles per Gallon (mpg)")
model1 <- lm(mpg ~ wt, data = data)
summary(model1)
ggplot(data, aes(x = wt, y = mpg)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
labs(title = "Least Squares Regression Line for MPG vs Weight")
new_data <- data.frame(wt = c(2.0, 3.0, 4.0, 5.0))
predictions <- predict(model1, newdata = new_data)
cbind(new_data, Predicted_MPG = predictions)
model2 <- lm(mpg ~ wt + hp, data = data)
summary(model2)
mean_hp <- mean(data$hp)
grid <- data.frame(
wt = seq(min(data$wt), max(data$wt), length.out = 50),
hp = mean_hp
)
grid$pred <- predict(model2, newdata = grid)
ggplot(data, aes(x = wt, y = mpg)) +
geom_point() +
geom_line(data = grid, aes(x = wt, y = pred), color = "red", size = 1) +
labs(title = "Multiple Regression: Effect of Weight on MPG (HP held constant)")
model3 <- lm(mpg ~ wt + cyl, data = data)
summary(model3)
grid_parallel <- expand.grid(
wt = seq(min(data$wt), max(data$wt), length.out = 50),
cyl = levels(data$cyl)
)
grid_parallel$mpg_pred <- predict(model3, newdata = grid_parallel)
View(model_parallel)
View(grid_parallel)
View(grid_parallel)
# Forcing the positions column to be of factor type bc I have been getting errors
nba_sample$positions <- factor(nba_sample$positions)
### Way we built in lab
model_parallel <- lm(PTS ~ Age + positions, data = nba_sample)
summary(model_parallel)
#############
grid_parallel <- expand.grid(
Age = seq(min(nba_sample$Age), max(nba_sample$Age), length.out = 50),
positions = levels(nba_sample$positions)
)
grid_parallel$PTS_pred <- predict(model_parallel, newdata = grid_parallel)
#############
ggplot(nba_sample, aes(x = Age, y = PTS, color = positions)) +
geom_point() +
geom_line(data = grid_parallel, aes(y = PTS_pred, color = positions), size = 1) +
labs(
title = "Parallel Lines Model",
x = "Age", y = "Points"
) +
theme_minimal()
View(grid_parallel)
# Fit non-parallel lines model with interaction
model_nonparallel <- lm(PTS ~ Age * positions, data = nba_sample)
summary(model_nonparallel)
# Plot
ggplot(nba_sample, aes(x = Age, y = PTS, color = positions)) +
geom_point() +
geom_line(data = grid_nonparallel, aes(y = PTS_pred, color = positions), size = 1) +
labs(
title = "Non-Parallel Lines: Interaction Between Age and Position",
x = "Age", y = "Points"
) +
theme_minimal()
# Fit non-parallel lines model with interaction
model_nonparallel <- lm(PTS ~ Age * positions, data = nba_sample)
summary(model_nonparallel)
# Plot
ggplot(nba_sample, aes(x = Age, y = PTS, color = positions)) +
geom_point() +
geom_line(data = nba_sample, aes(y = PTS_pred, color = positions), size = 1) +
labs(
title = "Non-Parallel Lines: Interaction Between Age and Position",
x = "Age", y = "Points"
) +
theme_minimal()
predict(model_parallel, newdata = data.frame(Age = 20, Position = "Center"))
predict(model_parallel, newdata = data.frame(Age = 20, Position = "center"))
predict(model_parallel, newdata = data.frame(Age = 20, positions = "center"))
predict(model_parallel, newdata = data.frame(Age = 20, positions = "Center"))
predict(model_parallel, newdata = data.frame(Age = 20, positions = "center"))
# Fit non-parallel lines model with interaction
model_nonparallel <- lm(PTS ~ Age * positions, data = nba_sample)
summary(model_nonparallel)
## plot
ggplot(nba_sample, aes(x = Age, y = PTS, color = positions)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(
title = "Non-Parallel Lines: Interaction Between Age and Position",
x = "Age", y = "Points"
)
# Predicted points for 20-year-old center
pred_center20 <- predict(model_interaction, newdata = nba_center20)
predict(model_parallel, newdata = data.frame(Age = 20, positions = "Center"))
predict(model_parallel, newdata = data.frame(Age = 20, positions = "center"))
# code from lab 5
## model
model_interaction <- lm(PTS ~ Age * positions, data = nba_sample)
summary(model_interaction)
## plot
ggplot(nba_sample, aes(x = Age, y = PTS, color = positions)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(
title = "Non-Parallel Lines: Interaction Between Age and Position",
x = "Age", y = "Points"
)
# Predicted points for 20-year-old center
pred_center20 <- predict(model_interaction, newdata = nba_center20)
cat("Predicted points for a 20-year-old Center:", pred_center20, "\n")
predict_20 <- predict(model_parallel, newdata = data.frame(Age = 20, positions = "center"))
cat("Predicted points for a 20-year-old Center:", pred_center20, "\n")
set.seed(123)
## one-row data frame for the target prediction (Age=20, Center)
nba_center20 <- data.frame(
Age = 20,
positions = factor("center", levels = levels(nba_sample$positions))
)
## Running bootstrap sample
boot_pred <- array(dim = 10000) # creating empty array
n <- nrow(nba_sample)
for (rr in 1:10000) {
I <- sample(1:n, n, replace = TRUE) # resample rows with replacement
boot_dat <- nba_sample[I, ] # new data
fit <- lm(PTS ~ Age * positions, data = boot_dat) # fitting model on bootstrap data
boot_pred[rr] <- predict(fit, newdata = nba_center20)
}
## Getting the confidence interval
bootleft_CI <- quantile(boot_pred, 0.025)
bootright_CI <- quantile(boot_pred, 0.975)
cat("Bootstrap 95% Confidence Interval: (", bootleft_CI, ", ", bootright_CI, ")")
# Loading data
# setwd("~/Documents/QTM 220")
nba_data <- read.csv("nba.data.csv")
# Checking Vals
unique(nba_data$POS)
# Creating the position_new variable to clean up
nba_data$positions <- ifelse(
nba_data$POS %in% c("PG", "SG", "G"), "guard",
ifelse(
nba_data$POS %in% c("PF", "SF", "F"), "forward",
ifelse(
nba_data$POS %in% c("C"), "center", NA
)
)
)
View(nba_data)
# Loading data
# setwd("~/Documents/QTM 220")
nba_data <- read.csv("nba.data.csv")
# Checking Vals
unique(nba_data$POS)
# Creating the position_new variable to clean up
nba_data$positions <- ifelse(
nba_data$POS %in% c("PG", "SG", "G"), "guard",
ifelse(
nba_data$POS %in% c("PF", "SF", "F"), "forward",
ifelse(
nba_data$POS %in% c("C"), "center", NA
)
)
)
# Sums
sum(is.na(nba_sample$POS))
# No nas... weird8
# Removing the text N/A
nba_sample <- nba_sample %>%
filter(POS != "N/A")
# Sums
sum(is.na(nba_data$POS))
# No nas... weird8
# Removing the text N/A
nba_data <- nba_data %>%
filter(POS != "N/A")
nba_scatter <- ggplot(nba_data, aes(x = Age, y = PTS, color = positions)) +
geom_point()
nba_scatter
# Forcing the positions column to be of factor type bc I have been getting errors
nba_data$positions <- factor(nba_data$positions)
### Way we built in lab
model_parallel <- lm(PTS ~ Age + positions, data = nba_data)
summary(model_parallel)
#############
grid_parallel <- expand.grid(
Age = seq(min(nba_data$Age), max(nba_data$Age), length.out = 50),
positions = levels(nba_data$positions)
)
grid_parallel$PTS_pred <- predict(model_parallel, newdata = grid_parallel)
#############
ggplot(nba_data, aes(x = Age, y = PTS, color = positions)) +
geom_point() +
geom_line(data = grid_parallel, aes(y = PTS_pred, color = positions), size = 1) +
labs(
title = "Parallel Lines Model",
x = "Age", y = "Points"
) +
theme_minimal()
# Forcing the positions column to be of factor type bc I have been getting errors
nba_data$positions <- factor(nba_data$positions)
### Way we built in lab
model_parallel <- lm(PTS ~ Age + positions, data = nba_data)
summary(model_parallel)
#############
grid_parallel <- expand.grid(
Age = seq(min(nba_data$Age), max(nba_data$Age), length.out = 50),
positions = levels(nba_data$positions)
)
grid_parallel$PTS_pred <- predict(model_parallel, newdata = grid_parallel)
#############
ggplot(nba_data, aes(x = Age, y = PTS, color = positions)) +
geom_point() +
geom_line(data = grid_parallel, aes(y = PTS_pred, color = positions), size = 1) +
labs(
title = "Parallel Lines Model",
x = "Age", y = "Points"
) +
theme_minimal()
## Predictions
predict_20 <- predict(model_parallel, newdata = data.frame(Age = 20, positions = "center"))
cat("Predicted points for a 20-year-old Center:", pred_center20, "\n")
predict_20 <- predict(model_parallel, newdata = data.frame(Age = 20, positions = "center"))
cat("Predicted points for a 20-year-old Center:", predict_20, "\n")
# Forcing the positions column to be of factor type bc I have been getting errors
nba_sample$positions <- factor(nba_sample$positions)
### Way we built in lab
model_parallel <- lm(PTS ~ Age + positions, data = nba_sample)
summary(model_parallel)
#############
grid_parallel <- expand.grid(
Age = seq(min(nba_sample$Age), max(nba_sample$Age), length.out = 50),
positions = levels(nba_sample$positions)
)
grid_parallel$PTS_pred <- predict(model_parallel, newdata = grid_parallel)
#############
ggplot(nba_sample, aes(x = Age, y = PTS, color = positions)) +
geom_point() +
geom_line(data = grid_parallel, aes(y = PTS_pred, color = positions), size = 1) +
labs(
title = "Parallel Lines Model",
x = "Age", y = "Points"
) +
theme_minimal()
predict_20 <- predict(model_parallel, newdata = data.frame(Age = 20, positions = "center"))
cat("Predicted points for a 20-year-old Center:", predict_20, "\n")
# Forcing the positions column to be of factor type bc I have been getting errors
nba_data$positions <- factor(nba_data$positions)
### Way we built in lab
model_parallel <- lm(PTS ~ Age + positions, data = nba_data)
summary(model_parallel)
#############
grid_parallel <- expand.grid(
Age = seq(min(nba_data$Age), max(nba_data$Age), length.out = 50),
positions = levels(nba_data$positions)
)
grid_parallel$PTS_pred <- predict(model_parallel, newdata = grid_parallel)
#############
ggplot(nba_data, aes(x = Age, y = PTS, color = positions)) +
geom_point() +
geom_line(data = grid_parallel, aes(y = PTS_pred, color = positions), size = 1) +
labs(
title = "Parallel Lines Model",
x = "Age", y = "Points"
) +
theme_minimal()
## Predictions
predict_20 <- predict(model_parallel, newdata = data.frame(Age = 20, positions = "center"))
cat("Predicted points for a 20-year-old Center:", predict_20, "\n")
nba_data %>%
filter(positions == "Center", Age == 20) %>%
summarise(mean_points = mean(PTS, na.rm = TRUE))
nba_data %>%
filter(positions == "center", Age == 20) %>%
summarise(mean_points = mean(PTS, na.rm = TRUE))
nba_data %>%
filter(positions == "center", Age == 20) %>%
mean_points = mean(PTS, na.rm = TRUE)
nba_data %>%
filter(positions == "center", Age == 20) %>%
mean_points = mean(PTS, na.rm = TRUE)
nba_data %>%
filter(positions == "center", Age == 20) %>%
summarise(mean_points = mean(PTS, na.rm = TRUE))
nba_data %>%
filter(positions == "center", Age == 20) %>%
mean(PTS, na.rm = TRUE)
nba_data %>%
filter(positions == "center", Age == 20) %>%
summarise(mean_points = mean(PTS, na.rm = TRUE))
# code from lab 5
## model
model_interaction <- lm(PTS ~ Age * positions, data = nba_data)
summary(model_interaction)
## plot
ggplot(nba_data, aes(x = Age, y = PTS, color = positions)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(
title = "Non-Parallel Lines: Interaction Between Age and Position",
x = "Age", y = "Points"
)
# Predicted points for 20-year-old center
pred_center20 <- predict(model_interaction, newdata = nba_center20)
cat("Predicted points for a 20-year-old Center:", pred_center20, "\n")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(modelr)
data <- data("mtcars")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(modelr)
data <- data("mtcars")
force(mtcars)
data("mtcars")
data <- mtcars
View(mtcars)
pt2_model <- lm('mpg ~ disp + hp', data = data)
summary(pt2_model)
data2 <- data
data$Residuals <- residuals(pt2_model)
data2 <- data
data2$Residuals <- residuals(pt2_model)
qqnorm(data2$Residuals, main = "Normal Qâ€“Q Plot")
qqline(data2$Residuals, col = "blue", lwd = 2, lty = 2)
hist(data2$Residuals, prob = TRUE, breaks = 10, col = "lightcoral",
main = "Residual Histogram", xlab = "Residuals")
grid <- sort(data2$Residuals)
lines(grid, dnorm(grid, mean = mean(data2$Residuals),
sd = sd(data2$Residuals)),
col = "maroon", lwd = 2)
# Residuals vs Fitted
plot(pt2_model, which = 1)
plot(pt2_model, which = 4)
plot(pt2_model, which = 5)
setwd("~/Documents/QTM 220/Final Project")
data <- read_csv("dataset.csv")
data <- read.csv("dataset.csv")
data <- read.csv("dataset.csv")
summary(data)
# energy and dancebility
library("ggplot2")
# energy and dancebility
library("ggplot2")
ggplot(data = data, aes(x = energy, y = danceability)) +
geom_point()
# energy and dancebility
library("ggplot2")
# Set seed bc data is massive
set.seed(123)
# Taking a 1000 random samples
data_1000 <- data[sample(nrow(data), size = min(1000, nrow(data))), ]
ggplot(data = data_1000, aes(x = energy, y = danceability)) +
geom_point()
# Tempo vs danceability
library("ggplot2")
# Set seed bc data is massive
set.seed(123)
# Taking a 1000 random samples
data_1000 <- data[sample(nrow(data), size = min(1000, nrow(data))), ]
ggplot(data = data_1000, aes(x = tempo, y = danceability)) +
geom_point()
# Visualizing the box-plot of average danceability by track_genre
# setting seed
set.seed(123)
data_sample <- data[sample(nrow(data), size = min(1000, nrow(data))), ]
# keep top 10 genres to avoid overcrowding
top_genres <- names(sort(table(data_sample$track_genre), decreasing = TRUE))[1:10]
plot_data <- subset(data_sample, track_genre %in% top_genres & !is.na(track_genre) & !is.na(danceability))
plot_data$track_genre <- factor(plot_data$track_genre, levels = top_genres)
ggplot(plot_data, aes(x = track_genre, y = danceability)) +
geom_boxplot() +
stat_summary(fun = mean, geom = "point", color = "red", size = 2) +
labs(x = "Track genre", y = "Danceability", title = "Danceability distribution by track genre (top 10 genres)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
unique(data$track_genre)
unique(data$track_genre)
# determine top 10 genres by count in the full dataset
top_genres <- data %>%
filter(!is.na(track_genre)) %>%
count(track_genre, sort = TRUE) %>%
slice_head(n = 10) %>%
pull(track_genre)
library(dplyr)
# determine top 10 genres by count in the full dataset
top_genres <- data %>%
filter(!is.na(track_genre)) %>%
count(track_genre, sort = TRUE) %>%
slice_head(n = 10) %>%
pull(track_genre)
# compute mean danceability for those genres using the entire dataset
plot_data <- data %>%
filter(track_genre %in% top_genres & !is.na(danceability)) %>%
group_by(track_genre) %>%
summarize(mean_danceability = mean(danceability, na.rm = TRUE), .groups = "drop") %>%
mutate(track_genre = factor(track_genre, levels = top_genres))
# plot means
ggplot(plot_data, aes(x = track_genre, y = mean_danceability)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = round(mean_danceability, 3)), vjust = -0.5, size = 3) +
labs(x = "Track genre", y = "Mean danceability", title = "Mean danceability by top 10 genres") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Visualizing the box-plot of average danceability by track_genre
# keep top 10 genres to avoid overcrowding
top_genres <- names(sort(table(data$track_genre), decreasing = TRUE))[1:10]
plot_data <- subset(data, track_genre %in% top_genres & !is.na(track_genre) & !is.na(danceability))
plot_data$track_genre <- factor(plot_data$track_genre, levels = top_genres)
ggplot(plot_data, aes(x = track_genre, y = danceability)) +
geom_boxplot() +
stat_summary(fun = mean, geom = "point", color = "red", size = 2) +
labs(x = "Track genre", y = "Danceability", title = "Danceability distribution by track genre (top 10 genres)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Visualizing the box-plot of average danceability by track_genre
# keep top 10 genres to avoid overcrowding
top_genres <- names(sort(table(data$track_genre), decreasing = TRUE))[1:10]
plot_data <- subset(data, track_genre %in% top_genres & !is.na(track_genre) & !is.na(danceability))
plot_data$track_genre <- factor(plot_data$track_genre, levels = top_genres)
ggplot(plot_data, aes(x = track_genre, y = danceability)) +
geom_boxplot() +
stat_summary(fun = mean, geom = "point", color = "red", size = 2) +
labs(x = "Track genre", y = "Danceability", title = "Danceability distribution by track genre (top 10 genres)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Visualizing the box-plot of average danceability by track_genre
# keep top 10 genres to avoid overcrowding
top_genres <- names(sort(table(data$track_genre), decreasing = TRUE))[1:10]
plot_data <- subset(data, track_genre %in% top_genres & !is.na(track_genre) & !is.na(danceability))
plot_data$track_genre <- factor(plot_data$track_genre, levels = top_genres)
ggplot(plot_data, aes(x = track_genre, y = danceability)) +
geom_boxplot() +
stat_summary(fun = mean, geom = "point", color = "red", size = 2) +
labs(x = "Track genre", y = "Danceability", title = "Danceability distribution by track genre (top 10 genres)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Visualizing the box-plot of average danceability by track_genre
# keep top 10 genres to avoid overcrowding
top_genres <- names(sort(table(data$track_genre), decreasing = TRUE))[1:10]
plot_data <- subset(data, track_genre %in% top_genres & !is.na(track_genre) & !is.na(danceability))
plot_data$track_genre <- factor(plot_data$track_genre, levels = top_genres)
ggplot(plot_data, aes(x = track_genre, y = danceability)) +
geom_boxplot() +
stat_summary(fun = mean, geom = "point", color = "red", size = 2) +
labs(x = "Track genre", y = "Danceability", title = "Danceability distribution by track genre (top 10 genres)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
